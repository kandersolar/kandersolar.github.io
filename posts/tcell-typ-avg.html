
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>T_cell_typ_avg &#8212; the kevbase</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=0fb7fa7b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'posts/tcell-typ-avg';</script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />

  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />

<link
  rel="alternate"
  type="application/atom+xml"
  href="../blog/atom.xml"
  title="kevbase"
/>



  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this site..."
         aria-label="Search this site..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/favicon.png" class="logo__image only-light" alt="the kevbase - Home"/>
    <img src="../_static/favicon.png" class="logo__image only-dark pst-js-only" alt="the kevbase - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../index.html">
    About
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../publications.html">
    Publications
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../blog.html">
    Blog
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../report.html">
    Climate Report
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../tools/index.html">
    Tools
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this site..."
         aria-label="Search this site..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../index.html">
    About
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../publications.html">
    Publications
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../blog.html">
    Blog
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../report.html">
    Climate Report
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../tools/index.html">
    Tools
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this site..."
         aria-label="Search this site..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

<div class="ablog-sidebar-item ablog__postcard">


<h2>
  
  
  <i class="fa fa-calendar"></i>
  
  <span>2021-06-17</span>
  
</h2>
<ul>
  <div class="ablog-sidebar-item ablog__postcard2">






<li id="ablog-sidebar-item tags ablog__tags">
  <span>
    
    
    <i class="fa-fw fa fa-tags"></i>
    
    
    </span>
  
  
  <a href="../blog/tag/photovoltaics.html">photovoltaics</a>
  
  
  
  
  
  <a href="../blog/tag/math.html">math</a>
  
  
  
</li>


</div>
</ul>
</div>
</div>
        <div class="sidebar-primary-item">

<div class="ablog-sidebar-item ablog__recentposts">
<h3>
  <a href="../blog.html">Recent Posts</a>
</h3>
<ul>
  
  
  <li>
    <a href="psm3-pixels-boundaries.html">
      04 September - PSM3 Pixel Boundaries
    </a>
  </li>
  
  <li>
    <a href="opengl-compute-shaders-spa-benchmarks.html">
      21 August - OpenGL Compute Shaders: SPA
    </a>
  </li>
  
  <li>
    <a href="opengl-compute-shaders-builtin-accuracy.html">
      13 August - OpenGL Compute Shaders: Accuracy of Math Functions
    </a>
  </li>
  
  <li>
    <a href="opengl-compute-shaders-first-steps.html">
      30 July - OpenGL Compute Shaders: First Steps
    </a>
  </li>
  
  <li>
    <a href="linalg-sparse-solve.html">
      09 April - Speeding up pvfactors
    </a>
  </li>
  
</ul>
</div>
</div>
        <div class="sidebar-primary-item">

<div class="ablog-sidebar-item ablog__archive">
<h3>
  <a href="../blog/archive.html">Archives</a>
</h3>
<ul>
  
  
  <li>
    <a href="../blog/2022.html">2022 (5)</a>
  </li>
  
  
  
  <li>
    <a href="../blog/2021.html">2021 (10)</a>
  </li>
  
  
  
  <li>
    <a href="../blog/2020.html">2020 (3)</a>
  </li>
  
  
</ul>
</div>
</div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">T_cell_typ_avg</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
<section class="tex2jax_ignore mathjax_ignore" id="t-cell-typ-avg">
<h1>T_cell_typ_avg<a class="headerlink" href="#t-cell-typ-avg" title="Link to this heading">#</a></h1>
<p>This is a short note that derives the “typical average cell temperature” used in
the “Weather-Corrected Performance Ratio”. The Weather-Corrected Performance Ratio
<a class="footnote-reference brackets" href="#id2" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> is defined as:</p>
<div class="math notranslate nohighlight">
\[
    \mathrm{PR_{corr}} = \frac{\sum_i \mathrm{EN_{AC}}_{\_i}}
                              {\sum_i \left[ P_{\mathrm{STC}} \left( \frac{G_{\mathrm{POA}\_i}}{G_{\mathrm{STC}}}\right) \left( 1 - \frac{\delta}{100}(T_{\mathrm{cell\_typ\_avg}} - T_{\mathrm{cell}\_i})\right) \right] }
\]</div>
<p>The denominator is essentially the PVWatts DC model, except the reference
cell temperature is not <span class="math notranslate nohighlight">\(T_{\mathrm{STC}}\)</span> but rather a “typical/average” cell
temperature.  The report has this to say about that decision:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Correction to a cell temperature of 25°C usually results in a higher PR
because modules more frequently operate at 45°C. Thus, while correction
to 25°C essentially solves the problem of seasonal variations, it may
overstate the actual performance and thus does not allow the financier
to assess the effect of local climate on the expected performance.
Therefore, correction to 25°C is not an acceptable method for removing
the seasonal variability in the PR metric because it would change the PR
value stated in the contract. 
</pre></div>
</div>
<p>Fair enough for back in 2013, but I wonder if this reasoning is still applicable
in 2021 (do financiers still look at PR?).  But I have several beefs with performance
ratios and they will have to wait for another day.</p>
<p>I’ve had several conversations over the years where people asked me why the
equation doesn’t use 25°C, and what the significance of this magic
irradiance-weighted average cell temperature is.  I think the above snippet
explains the motivation, but here’s a derivation of why it is defined the way it is.</p>
<p>Let’s start by assuming that there is some <span class="math notranslate nohighlight">\(T^*\)</span> such that this relation holds,
<em>i.e.</em> the two PRs are equal:</p>
<div class="math notranslate nohighlight">
\[
    \frac{\sum_i \mathrm{EN_{AC}}_{\_i}}
         {\sum_i \left[ P_{\mathrm{STC}} \left( \frac{G_{\mathrm{POA}\_i}}{G_{\mathrm{STC}}}\right)\right] }
         =
    \frac{\sum_i \mathrm{EN_{AC}}_{\_i}}
         {\sum_i \left[ P_{\mathrm{STC}} \left( \frac{G_{\mathrm{POA}\_i}}{G_{\mathrm{STC}}}\right) \left( 1 - \frac{\delta}{100}(T^* - T_{\mathrm{cell}\_i})\right) \right] }
\]</div>
<p>The numerators are equal (and nonzero), so the denominators must be equal as well:</p>
<div class="math notranslate nohighlight">
\[
    \sum_i \left[ P_{\mathrm{STC}} \left( \frac{G_{\mathrm{POA}\_i}}{G_{\mathrm{STC}}}\right)\right]
    =
    \sum_i \left[ P_{\mathrm{STC}} \left( \frac{G_{\mathrm{POA}\_i}}{G_{\mathrm{STC}}}\right) \left( 1 - \frac{\delta}{100}(T^* - T_{\mathrm{cell}\_i})\right) \right] 
\]</div>
<p><span class="math notranslate nohighlight">\(P_{\mathrm{STC}}\)</span> and <span class="math notranslate nohighlight">\(G_{\mathrm{STC}}\)</span> are constants that can be factored out of the summations and then canceled:</p>
<div class="math notranslate nohighlight">
\[
    \sum_i G_{\mathrm{POA}\_i}
    =
    \sum_i \left[  G_{\mathrm{POA}\_i} \left( 1 - \frac{\delta}{100}(T^* - T_{\mathrm{cell}\_i})\right) \right] 
\]</div>
<p>We can distribute the right-hand side and separate the sums:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{split}
    \sum_i G_{\mathrm{POA}\_i}
    &amp;=
    \sum_i \left[ G_{\mathrm{POA}\_i} \left( 1 - \frac{\delta}{100}(T^* - T_{\mathrm{cell}\_i})\right) \right] 
    \\
    &amp;= \sum_i G_{\mathrm{POA}\_i}  - \sum_i \left[G_{\mathrm{POA}\_i} \left( \frac{\delta}{100}(T^* - T_{\mathrm{cell}\_i})\right) \right] 
    \end{split}
\end{split}\]</div>
<p>The irradiance summations cancel, reducing to:</p>
<div class="math notranslate nohighlight">
\[
\sum_i \left[ G_{\mathrm{POA}\_i} \left( \frac{\delta}{100}(T^* - T_{\mathrm{cell}\_i})\right) \right] = 0
\]</div>
<p>Assuming <span class="math notranslate nohighlight">\(\delta/100 \neq 0\)</span>, we can factor it out of the summation and cancel it, leaving:</p>
<div class="math notranslate nohighlight">
\[
\sum_i \left[ G_{\mathrm{POA}\_i} (T^* - T_{\mathrm{cell}\_i})\right] = 0
\]</div>
<p>Distributing again, we find:</p>
<div class="math notranslate nohighlight">
\[
\sum_i \left[ G_{\mathrm{POA}\_i} T^* \right] = \sum_i \left[ G_{\mathrm{POA}\_i}  T_{\mathrm{cell}\_i}\right]
\]</div>
<p>As <span class="math notranslate nohighlight">\(T^*\)</span> is a constant, we can factor it out of the summation and then solve for it:</p>
<div class="math notranslate nohighlight">
\[
T^* = \frac{ \sum_i \left[ G_{\mathrm{POA}\_i}  T_{\mathrm{cell}\_i}\right]}{\sum_i G_{\mathrm{POA}\_i}}
\]</div>
<p>And we are done: the right-hand expression is exactly the definition of <span class="math notranslate nohighlight">\(T_{\mathrm{cell\_typ\_avg}}\)</span>
in the technical report (Eq 5).</p>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<hr class="footnotes docutils" />
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id2" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>T. Dierauf et al., “Weather-Corrected Performance Ratio”, NREL Technical
Report TP-5200-57991.  April 2013.  https://doi.org/10.2172/1078057</p>
</aside>
</aside>
</section>
</section>

<div class="section ablog__blog_comments">
  
  


<div class="section ablog__prev-next">
  <span class="ablog__prev">
    
    
    <a href="floating-point-fun.html">
      
      <i class="fa fa-arrow-circle-left"></i>
      
      <span>Floating Point Fun</span>
    </a>
    
  </span>
  <span class="ablog__spacer">&nbsp;</span>
  <span class="ablog__next">
    
    
    <a href="merra2-vs-psm3.html">
      <span>Comparing PSM3 and MERRA2 GHI</span>
      
      <i class="fa fa-arrow-circle-right" ></i>
      
    </a>
    
  </span>
</div>

  
  
</div>

                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2015-2024, Kevin Anderson.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.0.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>